## RNA-Seq Transcriptomics Pipeline

This repository provides a Linux-based RNA-Seq transcriptomics analysis pipeline that performs end-to-end processing of RNA sequencing data, starting from raw FASTQ files and ending with a merged gene expression count matrix. The pipeline is designed to be reproducible, interactive, and easy to understand, making it suitable for students, beginners in bioinformatics, and researchers who want a transparent RNA-Seq workflow.

## What is RNA-Seq?

RNA sequencing (RNA-Seq) is a high-throughput sequencing technique used to study the transcriptome, which represents all RNA molecules expressed in a biological sample at a specific time and condition. RNA-Seq enables quantitative measurement of gene expression, identification of differentially expressed genes, discovery of novel transcripts and splice variants, and exploration of functional genomics and regulatory mechanisms. A typical RNA-Seq experiment involves RNA isolation, library preparation, sequencing using platforms such as Illumina, quality control of reads, trimming of low-quality sequences and adapters, alignment of reads to a reference genome, gene-level read counting, and downstream statistical analysis using tools such as DESeq2 or edgeR. This repository focuses on the computational steps starting from quality control up to gene-level read counting.

## Getting Raw RNA-Seq Data from NCBI

Public RNA-Seq datasets can be obtained from the NCBI Sequence Read Archive (SRA). A typical workflow involves identifying a project accession such as PRJNA394193, installing the SRA Toolkit, and downloading sequencing data in FASTQ format. The following command can be used to download paired-end reads and convert them into FASTQ files:

```fasterq-dump SRRXXXXXXX --split-files --threads 8```


## This pipeline assumes that each biological sample is organized in a separate directory containing paired-end FASTQ files. The expected directory layout is shown below:

```PROJECT_DIR/
â”œâ”€â”€ 001/
â”‚   â”œâ”€â”€ sample_1.fastq.gz
â”‚   â””â”€â”€ sample_2.fastq.gz
â”œâ”€â”€ 002/
â”‚   â”œâ”€â”€ sample_1.fastq.gz
â”‚   â””â”€â”€ sample_2.fastq.gz
```

Each subdirectory represents one sample, where the _1.fastq.gz and _2.fastq.gz files correspond to forward and reverse reads respectively.

## install_tools.sh â€“ Tool Installation and Setup

The install_tools.sh script is responsible for preparing the system and pipeline environment. It updates the system package list and installs all core dependencies such as Java, Python, wget, unzip, and other required utilities. The script also installs essential bioinformatics tools including HISAT2 for read alignment, SAMtools for processing SAM and BAM files, FastQC for read quality assessment, and MultiQC for summarizing quality control reports. In addition, it downloads and installs Trimmomatic version 0.39 locally inside the pipeline directory and creates the required folders named genome_data and hisat2_index. This script ensures reproducibility, prevents manual dependency-related errors, and can be safely executed multiple times without affecting existing installations. The script needs to be run once before starting the analysis:

```./install_tools.sh```

## fastqc_trim.sh â€“ Quality Control and Trimming

The fastqc_trim.sh script performs quality assessment and optional trimming of raw RNA-Seq reads. It automatically detects paired-end FASTQ files within each sample directory and runs FastQC to evaluate the quality of the raw reads. After the initial quality assessment, the script pauses and asks the user whether trimming should be performed. If the user agrees, Trimmomatic is executed to remove adapter sequences and low-quality bases, followed by another round of FastQC on the trimmed reads. This interactive design allows users to inspect read quality before trimming. The outputs generated by this script are organized within each sample directory as shown below:

```sample/
â”œâ”€â”€ fastqc_raw/
â”œâ”€â”€ trimmed/
â”‚   â”œâ”€â”€ *_paired.fastq.gz
â”‚   â””â”€â”€ *_unpaired.fastq.gz
```


This approach ensures clean organization of results, automatic sample handling, and prevents reprocessing of samples that have already been analyzed.

## run_alignment.sh â€“ Alignment and Read Counting

The run_alignment.sh script aligns trimmed reads to a reference genome and generates gene-level expression counts. It automatically detects the genome FASTA file and the corresponding GTF annotation from the genome_data directory. If a HISAT2 index is not already present, the script builds it and stores it in the hisat2_index directory. Trimmed reads are then aligned using HISAT2, and the resulting SAM files are converted into sorted and indexed BAM files. Finally, HTSeq-count is used to calculate gene-level read counts. The output produced by this script is structured as follows:

````sample/
â”œâ”€â”€ hisat2/
â”‚   â””â”€â”€ sample.sorted.bam
â”œâ”€â”€ htseq_counts/
â”‚   â””â”€â”€ sample_counts.txt
````


This design avoids redundant index rebuilding, skips alignment if BAM files already exist, and maintains a clean and organized directory structure.

## merge.py â€“ Merging Count Files

The merge.py script is a Python utility that combines individual sample-level count files into a single gene expression matrix. It automatically detects sample directories, reads HTSeq count files from each sample, and merges them based on gene identifiers. The final output is written as an Excel file named:

```All_samples_counts.xlsx```


This merged count matrix can be directly used for downstream differential expression analysis using tools such as DESeq2, edgeR, Limma, or other transcriptomic analysis frameworks.

## Folder Descriptions

The genome_data directory stores reference genome and annotation files required for alignment and read counting. These typically include a genome FASTA file and a GTF annotation file, as shown below:

```genome_data/
â”œâ”€â”€ genome.fa
â””â”€â”€ annotation.gtf
```
## ğŸ“ genome_data/

Contains reference genome files:

Genome FASTA (.fa, .fasta, .fa.gz)

Annotation file (.gtf, .gtf.gz)


The hisat2_index directory contains HISAT2 index files generated automatically during alignment. Storing these files avoids rebuilding the index for every run, significantly speeding up the pipeline.

## ğŸ“ hisat2_index/

Stores HISAT2 genome index files (*.ht2) generated automatically.

Purpose:

Speeds up alignment

Avoids rebuilding index every run

## Recommended Pipeline Execution Order

The pipeline should be executed in the following order to ensure correct processing:

```./install_tools.sh
./fastqc_trim.sh
./run_alignment.sh
python3 merge.py
```

